<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Random Thoughts on Deep Learning</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description">
<meta property="og:type" content="website">
<meta property="og:title" content="Random Thoughts on Deep Learning">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="Random Thoughts on Deep Learning">
<meta property="og:description">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Random Thoughts on Deep Learning">
<meta name="twitter:description">
  
    <link rel="alternate" href="/atom.xml" title="Random Thoughts on Deep Learning" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  

</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Random Thoughts on Deep Learning</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-Multitask-CNN" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/07/19/Multitask-CNN/" class="article-date">
  <time datetime="2016-07-19T15:08:37.000Z" itemprop="datePublished">2016-07-19</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/07/19/Multitask-CNN/">Multitask_CNN</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Face landmark detection can be combined with other tasks, such as gender classification, pose estimation and so on. This is usually referred as multi-task CNN learning in this context. It is not very difficult to adapt a single-task CNN to a multi-task CNN. We only need to modify the prototxt file and properly define the input and ouput data structures. Here I given an example of multi-task CNN based on VanillaCNN structure.</p>
<p>The network structure is given as follows:</p>
<p><img src="img/20160719/vanilla_multitask.png" alt="VanillaCNN_Multitask"></p>
<p>The dataset is provided as follows:</p>
<p><a href="http://mmlab.ie.cuhk.edu.hk/projects/TCDCN.html" target="_blank" rel="external">http://mmlab.ie.cuhk.edu.hk/projects/TCDCN.html</a></p>
<p>A recent work, namely “HyperFace”, also provides very detailed analysis on how we can perform multi-task learning with CNN. The presented ideas are very straightforward and can be easily implemented, at least for the multi-task CNN part or the individual parts. </p>
<p><a href="http://arxiv.org/abs/1603.01249" target="_blank" rel="external">http://arxiv.org/abs/1603.01249</a></p>
<p>You can see the HyperFace network structure here. I have briefly copied the figure from the paper. </p>
<p><img src="img/20160719/hyperface.png" alt="HyperFace"></p>
<p>Besides, you can also check the multitask network structure. </p>
<p><img src="img/20160719/multitask_face.png" alt="HyperFace"></p>
<p>As mentioned in the paper, the networks are modified from the Region-based CNN, which is derived from AlexNet. </p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/07/19/Multitask-CNN/" data-id="ciqtmh5460000xes6xjxjqokv" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-vanillacnn" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/06/28/vanillacnn/" class="article-date">
  <time datetime="2016-06-28T13:40:03.000Z" itemprop="datePublished">2016-06-28</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/06/28/vanillacnn/">vanillacnn</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Face alignment can be solved by applying a very straightforward CNN approach. That means we can “tweak” traditional CNN used by image classification to do regression task for face alignment. </p>
<p>Yue Wu<em>, Tal Hassner</em>, KangGeon Kim, Gerard Medioni and Prem Natarajan, Facial Landmark Detection with Tweaked Convolutional Neural Networks, arXiv preprint arXiv:1511.04031, 21 Mar 2016</p>
<p><a href="http://www.openu.ac.il/home/hassner/projects/tcnn_landmarks/" target="_blank" rel="external">http://www.openu.ac.il/home/hassner/projects/tcnn_landmarks/</a></p>
<p>ishay2b@github.com has implementation for this paper, basically the VanillaCNN part.<br><a href="https://github.com/ishay2b/VanillaCNN" target="_blank" rel="external">https://github.com/ishay2b/VanillaCNN</a></p>
<p>I have retrained the model with the MTFL dataset (10,000) images with five landmarks annotated. The test is AFLW dataset with 2995 images (~3000). You can access the MTFL dataset from the following link:<br><a href="http://mmlab.ie.cuhk.edu.hk/projects/TCDCN.html" target="_blank" rel="external">http://mmlab.ie.cuhk.edu.hk/projects/TCDCN.html</a></p>
<p>It is noted that the same training dataset has been used in cascaded CNN work.<br><a href="http://mmlab.ie.cuhk.edu.hk/archive/CNN_FacePoint.htm" target="_blank" rel="external">http://mmlab.ie.cuhk.edu.hk/archive/CNN_FacePoint.htm</a></p>
<p>So please do not confuse with the naming conventions used in the package. </p>
<p>The first step is to retrain the model by using the provided package. The default set of parameters is used. </p>
<h2 id="Experimental-Result"><a href="#Experimental-Result" class="headerlink" title="Experimental Result"></a>Experimental Result</h2><h3 id="Results-on-AFLW-and-AFW-datasets-by-VanillaCNN"><a href="#Results-on-AFLW-and-AFW-datasets-by-VanillaCNN" class="headerlink" title="Results on AFLW and AFW datasets by VanillaCNN"></a>Results on AFLW and AFW datasets by VanillaCNN</h3><p>Test Error AFLW: 8.545266 mean error, 2535 items, 606 failures  0.239053 precent<br>Test Error AFW:  7.905281 mean error, 141 items, 25 failures  0.177305 precent</p>
<h3 id="Results-on-AFLW-and-AFW-datasets-by-ECCV-14-paper"><a href="#Results-on-AFLW-and-AFW-datasets-by-ECCV-14-paper" class="headerlink" title="Results on AFLW  and AFW datasets by ECCV 14 paper"></a>Results on AFLW  and AFW datasets by ECCV 14 paper</h3><p>Test Error AFLW: 8.545266 mean error, 8.0<br>Test Error AFW: 8.545266 mean error, 8.2</p>
<h2 id="Visualization-the-Network"><a href="#Visualization-the-Network" class="headerlink" title="Visualization the Network"></a>Visualization the Network</h2><p>I have plotted the CNN network used in this experiment.</p>
<p><img src="img/VanillaCNN.png" alt="Vanilla CNN Network"></p>
<h2 id="Face-Alignment-Results-on-LFPW-dataset"><a href="#Face-Alignment-Results-on-LFPW-dataset" class="headerlink" title="Face Alignment Results on LFPW dataset"></a>Face Alignment Results on LFPW dataset</h2><div id="image-table"><br>    <table><br>        <tr><br>            <td style="padding:5px"><br>                <img src="img/VanillaCNN_detection/0132-image31201.jpg" height="200" width="250"><br>              </td><br>            <td style="padding:5px"><br>                <img src="img/VanillaCNN_detection/0177-image71131.jpg" height="200" width="250"><br>             </td><br>            <td style="padding:5px"><br>                <img src="img/VanillaCNN_detection/0223-image08358.jpg" height="200" width="250"><br>             </td><br>                        <td style="padding:5px"><br>                <img src="img/VanillaCNN_detection/0275-image17840.jpg" height="200" width="250"><br>             </td><br>        </tr><br>    </table><br></div>




      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/06/28/vanillacnn/" data-id="ciqtmh54f0003xes636k7xusw" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-CNN-for-Facial-Point-Detection" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/06/20/CNN-for-Facial-Point-Detection/" class="article-date">
  <time datetime="2016-06-20T15:21:36.000Z" itemprop="datePublished">2016-06-20</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/06/20/CNN-for-Facial-Point-Detection/">CNN for Facial Point Detection</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>After Alexnet won 2012 ImageNet competition, deep learning has become one of the most promising fields in the computer vision field. Convolutional Neural Network (CNN) has attracted much attention since then. </p>
<p>Tang’s group has proposed the use of CNN in a cascade manner to train the landmark detection from coarse to fine. </p>
<p>Reference: Y. Sun, X. Wang, and X. Tang. Deep Convolutional Network Cascade for Facial Point Detection. In Proceedings of IEEE Conference on Computer Vision and Pattern Recognition (CVPR), 2013. </p>
<p>Here is an implementation for the above proposed method, thanks to luoyetx@github.com.</p>
<p><a href="https://github.com/luoyetx/deep-landmark" target="_blank" rel="external">https://github.com/luoyetx/deep-landmark</a></p>
<p>I have retrained the code with just one level, i.e., full face region with five landmarks. The results seem to be pretty good.</p>
<p>I have used the provided dataset from the website to train the CNN at level 1, which contains 5,590 LFW images and 7,876 other images. </p>
<h2 id="Experimental-Result"><a href="#Experimental-Result" class="headerlink" title="Experimental Result"></a>Experimental Result</h2><h3 id="Results-on-7-876-images"><a href="#Results-on-7-876-images" class="headerlink" title="Results on 7,876 images"></a>Results on 7,876 images</h3><p>Test Number: 3466<br>Time Consume: 69.566 s<br>FPS: 49.823<br>LEVEL - 1<br>Mean Error:<br>    Left Eye       = 0.022343<br>    Right Eye      = 0.023272<br>    Nose           = 0.030272<br>    Left Mouth     = 0.028617<br>    Right Mouth    = 0.028821<br>Failure:<br>    Left Eye       = 0.059146<br>    Right Eye      = 0.063474<br>    Nose           = 0.140219<br>    Left Mouth     = 0.111079<br>    Right Mouth    = 0.118003</p>
<h2 id="Visualization-the-Network"><a href="#Visualization-the-Network" class="headerlink" title="Visualization the Network"></a>Visualization the Network</h2><p>I have plotted the CNN network used in this experiment.</p>
<p><img src="img/cascade_cnn.jpg" alt="CNN network"></p>
<h2 id="Face-Alignment-Results-on-LFPW-dataset"><a href="#Face-Alignment-Results-on-LFPW-dataset" class="headerlink" title="Face Alignment Results on LFPW dataset"></a>Face Alignment Results on LFPW dataset</h2><div id="image-table"><br>    <table><br>        <tr><br>            <td style="padding:5px"><br>                <img src="img/20160220/log/156.jpg" alt="Demo Result 1" height="200" width="250"><br>              </td><br>            <td style="padding:5px"><br>                <img src="img/20160220/log/159.jpg" alt="Demo Result 2" height="200" width="250"><br>             </td><br>        </tr><br>    </table><br></div>

<p>However, by using Level 1 is not sufficient in this case.  We still need to add more levels to train the CNN. Level 1 just provides a coarse estimation of landmark here.</p>
<div id="image-table"><br>    <table><br>        <tr><br>            <td style="padding:5px"><br>                <img src="img/20160220/log/163.jpg" alt="Demo Result 3" height="200" width="250"><br>              </td><br>            <td style="padding:5px"><br>                <img src="img/20160220/log/167.jpg" alt="Demo Result 4" height="200" width="250"><br>             </td><br>        </tr><br>    </table><br></div>


      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/06/20/CNN-for-Facial-Point-Detection/" data-id="ciqtmh54b0001xes6qm8p819e" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-hello-world" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/06/17/hello-world/" class="article-date">
  <time datetime="2016-06-17T14:26:44.000Z" itemprop="datePublished">2016-06-17</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/06/17/hello-world/">Caffe Visualization</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>The visualization of deep learning network is very helpful to understand the global structure of how the network is evolved. Fortunately, caffe has already provided such a tool to visualize the network, namely via plotting the nets defined in prototxt file. </p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Install-the-graphviz"><a href="#Install-the-graphviz" class="headerlink" title="Install the graphviz"></a>Install the graphviz</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ pip install pydot</span><br><span class="line">$ sudo apt-get instll graphviz</span><br></pre></td></tr></table></figure>
<h3 id="Execute-the-commands"><a href="#Execute-the-commands" class="headerlink" title="Execute the commands"></a>Execute the commands</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">cd</span> caffe/examples</span><br><span class="line">$ python python/draw_net.py  yourPath.prototxt yourNetwork.name</span><br></pre></td></tr></table></figure>
<h2 id="Visualization-Results"><a href="#Visualization-Results" class="headerlink" title="Visualization Results"></a>Visualization Results</h2><p>I have plotted two CNN networks which have been used to perform face landmark detection. The task of face landmark detection uses HDF5 format to store the input and switch the last layer of classifier to regression. </p>
<p><img src="img/cascade_cnn.jpg" alt="CNN network used in luoyetx@github.com"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/06/17/hello-world/" data-id="ciqtmh54d0002xes6borkpc62" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  

</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/07/">July 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/06/">June 2016</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2016/07/19/Multitask-CNN/">Multitask_CNN</a>
          </li>
        
          <li>
            <a href="/2016/06/28/vanillacnn/">vanillacnn</a>
          </li>
        
          <li>
            <a href="/2016/06/20/CNN-for-Facial-Point-Detection/">CNN for Facial Point Detection</a>
          </li>
        
          <li>
            <a href="/2016/06/17/hello-world/">Caffe Visualization</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2016 Cunjian Chen<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>